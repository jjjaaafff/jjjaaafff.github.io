<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Potential Outcome | Aofan Jiang</title> <meta name="author" content="Aofan Jiang"> <meta name="description" content="Lecture Notes on Causal Inference"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.png"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jjjaaafff.github.io/blog/2021/causal2/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Potential Outcome",
      "description": "Lecture Notes on Causal Inference",
      "published": "July 11, 2021",
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span>Aofan Jiang (蒋傲凡)</span></a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>Potential Outcome</h1> <p>Lecture Notes on Causal Inference</p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#average-treatment-effect-ate">Average treatment effect (ATE)</a></div> <div><a href="#assumption-for-ate-associational-difference">Assumption for ATE = associational difference</a></div> <div><a href="#tying-it-all-together">Tying it all together</a></div> </nav> </d-contents> <h2 id="average-treatment-effect-ate">Average treatment effect (ATE)</h2> <p>用平均的方式替代个体，来解决causal effect无法得到的问题。即\(E_i[Y_i(1)-Y_i(0)]\)，通常我们省略下标i，写作\(E[Y(1)-Y(0)]\) 其中，最关键的一点是：</p> \[E[Y(1)-Y(0)] = E[Y(1)]-E[Y(0)] \neq E[Y|T=1]-E[Y|T=0]\] <p>最后一项被称为associational difference。正如之前所解释的那样，不等关系源自两组数据间的不可比性。那么什么样的数据是可比的呢？还是以穿鞋睡觉与起床头疼为例，如果我们以上床前穿鞋与否进行划分，则此时两组人内清醒与醉酒的数量接近，是可比的。</p> <h2 id="assumption-for-ate--associational-difference">Assumption for ATE = associational difference</h2> <ul> <li>第一条假设称为 Ignorability: \((Y(0),Y(1))\) are independent of T<br> 根据这条假设，我们可以得到</li> </ul> \[E[Y(1)-Y(0)] = E[Y(1)|T=1]-E[Y(0)|T=0]\] <p>为什么称为 ignorability呢？这是因为基于这条假设，我们可以忽略掉潜在原因对 T 和 Y 的影响(主要是对 T 的影响)<br> 该假设的另一个解释角度，称为 exchangeability。意思是说，在我们交换 T 不同的两组人之后，结果仍然保持不变，即</p> \[E[Y(1)\vert T=1] = E[Y(1)\vert T=0] = E[Y(1)]\] <p>我们之所以想把 causal quantities (e.g. \(E[Y(1)]\)) 变成 statistical quantities (e.g. \(E[Y\vert T=1]\))，就是因为后者可以从 P(x,t,y) 的联合概率分布中得到，由此引出 identifiability的概念。<br> 我们称一个 causal quantities (e.g. \(E[Y(t)]\))是 identifiable，如果它可以由statistical quantities (e.g. \(E[Y\vert t]\))计算得到</p> <ul> <li>第二条假设与之类似，Conditional exchangeability: \((Y(0),Y(1))\) are independent of T given X<br> 根据这条假设，我们可以得到</li> </ul> \[E[Y(1)-Y(0)\vert X] = E[Y(1)|T=1,X]-E[Y(0)|T=0,X]\] <p>结合我们之前得到的ATE形式，我们可以得到修改后的版本，即identification of ATE</p> \[E[Y(1)-Y(0)] = E_XE[Y(1)-Y(0)\vert X] = above\ formula\] <p>此外，该假设还有很多不同称呼，unconfoundedness、conditional ignorability、 conditional exchangeability等。<br> 这是一条无法被验证的假设，因为我们不能保证没有其他潜在原因影响 T 与 Y，若存在这样一个潜在原因，则此时该假设不成立。</p> <ul> <li>第三条假设是 Positivity: \(0&lt;P(T=1\vert X=x)&lt;1\)<br> 这是一条我们必须保证的性质，因为我们可以把条件概率用贝叶斯拆开，此时Positivity对应的那一项出现在分母，我们需要避免除零的情况。<br> 对该性质的理解，有两种理解方式 <ul> <li>第一种是直觉上，假如 \(P(T=1\vert X=x)=1\)，则说明在 x 原因的作用下，所有人都采取了T=1的方式，那么此时我们无法分析Y与T的关系</li> <li>第二种是overlap的角度，我们画出 \(P(x\vert t)=1\) 与 x 的坐标图，对T=0和T=1分别绘图，如果两部分没有重叠，则说明严重违反了 Positivity性质。</li> </ul> </li> </ul> <p>Positivity-Unconfoundedness 存在tradeoff的关系，当维度越多，overlap的面积就越小<br> 如果我们真的违反了 Positivity性质会发生什么？Extrapolation<br> <img src="/assets/img/ICI_lec2_1.JPG" alt="" title="建模表现变差"></p> <ul> <li>第四条假设是 No interference: 其他个体采取的措施对当前个体的观测结果无影响，即</li> </ul> \[Y_i(t_1, . . . , t_{i-1}, t_i, t_{i+1}, . . . , t_n) = Y_i(t_i)\] <p>举例来说，如果我养一条狗会开心，那么其他人养狗则不会对我的心情产生影响</p> <ul> <li>最后一条假设是 Consistency：当我们采取措施 T=t 时，观察到的结果就是潜在结果Y(t)，即</li> </ul> \[T=t \Longrightarrow Y=Y(t)\] <p>这个假设看起来是非常直觉的。举例来说，用 T=1 表示养一条狗，T=0 表示不养狗；同时，我养白狗会开心，养黑狗不开心，那么此时 Consistency 假设就被违反了。违反的原因来自举措 T 定义的不严谨</p> <h2 id="tying-it-all-together">Tying it all together</h2> <p>在这里，我们结合之前提到的所有假设，对 causal effect 进行操作变形。</p> <ol> <li> <p>为解决因果分析的根本问题，我们用ATE代替个人，并省略下标i，即</p> \[E_i[Y_i(1) - Y_i(0)] = E[Y (1)-Y (0)]\] </li> <li> <p>根据期望的线性性质和基本原理，将Causal estimand转换为Statistical estimand，即</p> \[E_i[Y_i(1) - Y_i(0)] = E_X[E[Y (1) \vert X] - E[Y (0) \vert X]]\] </li> <li> <p>根据 unconfoundedness 和 positivity 假设，增加 T 因素，即</p> \[E_i[Y_i(1) - Y_i(0)] = E_X[E[Y (1) \vert T=1, X] - E[Y (0) \vert T=0, X]]\] </li> <li> <p>根据 consistency 假设，进一步化简，得到最终形式，即</p> \[E_i[Y_i(1) - Y_i(0)] = E_X[E[Y\vert T=1, X] - E[Y\vert T=0, X]]\] </li> </ol> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2023 Aofan Jiang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Last updated: November 14, 2023. </div> <div id="map-container" style="display: none;"> <script type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?cl=ffffff&amp;w=300&amp;t=n&amp;d=vcetvMKxQeU0A74GGVddvtKdDYpzY562Hjs3OBdOjBw"></script> </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>